From 2e351d7b8b8c39ca2a7367315690a89243ee1379 Mon Sep 17 00:00:00 2001
From: psykose <alice@ayaya.dev>
Date: Sat, 9 Apr 2022 16:29:03 +0000
Subject: [PATCH] don't walk over sun_path size limit in snprintf()

---
 src/sockets.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/src/sockets.c b/src/sockets.c
index 9ddd6ce..231d67e 100644
--- a/src/sockets.c
+++ b/src/sockets.c
@@ -87,7 +87,7 @@ ssize_t socket_write(int fd, char *data, size_t len) {
 void socket_path(struct sockaddr_un *addr) {
 	size_t sun_path_size = sizeof(addr->sun_path);
 
-	char name[sun_path_size];
+	char name[sun_path_size - 4];
 	if (getenv("XDG_VTNR")) {
 		snprintf(name, sizeof(name), "/way-displays.%s.sock", getenv("XDG_VTNR"));
 	} else {
-- 
2.35.1

