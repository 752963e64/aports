# Contributor: TBK <alpine@jjtc.eu>
# Maintainer: TBK <alpine@jjtc.eu>
pkgname=libwbxml
pkgver=0.11.6
pkgrel=1
pkgdesc="A library to encode and decode WBXML (WAP Binary XML)."
url="https://github.com/libwbxml/libwbxml"
arch="all"
license="LGPL-2.1-or-later"
makedepends="cmake expat-dev"
checkdepends="check-dev"
subpackages="$pkgname-dev $pkgname-doc"
source="https://github.com/libwbxml/libwbxml/archive/libwbxml-$pkgver.tar.gz"
builddir="$srcdir/$pkgname-$pkgname-$pkgver"

build() {
	if [ "$CBUILD" != "$CHOST" ]; then
		CMAKE_CROSSOPTS="-DCMAKE_SYSTEM_NAME=Linux -DCMAKE_HOST_SYSTEM_NAME=Linux"
	fi
	cmake -B build \
		-DCMAKE_INSTALL_PREFIX=/usr \
		-DENABLE_UNIT_TEST=ON \
		$CMAKE_CROSSOPTS .
	make -C build
}

check() {
	make -C build test
}

package() {
	make -C build DESTDIR="$pkgdir" install

	mkdir -p "$pkgdir"/usr/lib
	mv "$pkgdir"/usr/share/cmake "$pkgdir"/usr/lib
}

sha512sums="a862afc0d8c997dfe3a8723b8580ca81ea28a205ca9129ef4756cc82ceca66fae51692a46f4227d4e871dd572bc2c9c8389844cd978ff06a91fb118917c06759  libwbxml-0.11.6.tar.gz"
