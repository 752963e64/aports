# Contributor: Jakub Jirutka <jakub@jirutka.cz>
# Maintainer: Jakub Jirutka <jakub@jirutka.cz>
pkgname=akms
pkgver=0_git20210803
_gitrev=e0e0a925a7d94fcce65af7de36a0941e5ea6d724
pkgrel=0
pkgdesc="Alpine Kernel Module Support"
url="https://github.com/jirutka/akms"
arch="noarch"
license="MIT"
depends="bubblewrap cmd:depmod kernel-hooks"
triggers="$pkgname.trigger=/usr/src/*"
install="$pkgname.pre-install $pkgname.post-install $pkgname.pre-deinstall"
source="https://github.com/jirutka/akms/archive/$_gitrev/$pkgname-$_gitrev.tar.gz
	akms.hook
	"
builddir="$srcdir/$pkgname-$_gitrev"
options="!check"  # no tests provided

package() {
	make install DESTDIR="$pkgdir" prefix=/usr
	install -D -m755 "$srcdir"/akms.hook "$pkgdir"/usr/share/kernel-hooks.d/akms.hook
}

sha512sums="
58cf5f1dab6cbc58fec445fab49bd1c0668107cde317f5b6de72cba51be8d226f2cee6f5b9ac87567b4bcd52f1fa1a812a3212ff6ca63264d5668f6323835867  akms-e0e0a925a7d94fcce65af7de36a0941e5ea6d724.tar.gz
5b80295491b7804b30700e66385e243d568542fc7679eb38389ff3b9ca60f0b67a42c89ec47210d7f58ad0f39bd016edcab7016c9a8609a861d17f42dfa4063b  akms.hook
"
