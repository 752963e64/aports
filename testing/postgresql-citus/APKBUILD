# Contributor: Michael Pirogov <vbnet.ru@gmail.com>
# Maintainer: Michael Pirogov <vbnet.ru@gmail.com>
pkgname=postgresql-citus
_projname=citus
pkgver=10.1.2
pkgrel=1
pkgdesc="Scalable PostgreSQL for multi-tenant and real-time analytics workloads"
url="https://github.com/citusdata/citus"
arch="all"
license="AGPL-3.0-only"
makedepends="autoconf postgresql-dev icu-dev lz4-dev zstd-dev"
provides="pg_cron=$pkgver-r$pkgrel"
install="$pkgname.post-install"
source="https://github.com/citusdata/citus/archive/v$pkgver/$_projname-$pkgver.tar.gz"
builddir="$srcdir/$_projname-$pkgver"
options="!check" # tests requires running postgresql cluster

prepare() {
	default_prepare
	autoreconf -fi
}

build() {
	./configure \
		--prefix=/usr \
		--without-libcurl
	make
}

package() {
	make DESTDIR="$pkgdir" install
	install -Dm644 LICENSE "$pkgdir"/usr/share/licenses/$pkgname/LICENSE
}

sha512sums="
9ae89944e11429203dc82a7db7733fcbc54d2396fcc3a364ea39923cb3e506730e92cd2c492aece4c03914587df4a3d39d9bc7ce253ef91576dd18c623cb45e7  citus-10.1.2.tar.gz
"
