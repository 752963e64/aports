# Maintainer: Paul Bredbury <brebs@sent.com>
pkgname=lout
pkgver=3.42
pkgrel=0
pkgdesc="Lightweight typesetting and document formatting system"
url="https://savannah.nongnu.org/projects/lout"
arch="all"
license="GPL-3.0-or-later"
makedepends="zlib-dev"
install="$pkgname.post-install"
subpackages="$pkgname-doc"
source="lout-$pkgver.tar.gz::https://github.com/william8000/lout/archive/refs/tags/$pkgver.tar.gz
	makefile.patch"
options="!check" # No test suite

# secfixes:
#   3.42-r0:
#     - CVE-2019-19917
#     - CVE-2019-19918

build() {
	make \
		USELOC=0 \
		PREFIX="/usr" \
		LIBDIR="$(PREFIX)/share/" \
		PDF_COMPRESSION=1 \
		ZLIB="-lz" \
		all
}
		#LOUTLIBDIR="$(PREFIX)/share/lout" \
		#LOUTDOCDIR="$(PREFIX)/share/doc/lout" \
		#MANDIR="$(PREFIX)/share/man/man1" \

package() {
	mkdir -p "$pkgdir/usr/bin" \
		"$pkgdir/usr/share/doc/lout" \
		"$pkgdir/usr/share/man/man1"

	make \
		PREFIX="$pkgdir/usr" \
		allinstall
}

sha512sums="
2c6e496bbacbce68f1c0b6a8c4b18eb275264c04eae14afc9f59fdc7578457da001c7f0fe4c0c1a1603618a1e4528ba41e53539c3c5e8e747221abaf9d1df8f2  lout-3.42.tar.gz
83cd3240f9e60fdb8f2075771f2f11b96e60f0e6fd99e4a3ef1feca7e043001d9607f40a3f13b6b566c080b4589f05d980fe0fb72e8db542b34f31c6dfda0bc2  makefile.patch
"
