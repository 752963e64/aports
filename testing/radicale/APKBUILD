# Contributor: SÃ¶ren Tempel <soeren+alpine@soeren-tempel.net>
# Maintainer: Natanael Copa <ncopa@alpinelinux.org>
pkgname=radicale
pkgver=2.1.12
pkgrel=0
pkgdesc="A simple CalDAV (calendar) and CardDAV (contact) server"
url="http://radicale.org"
arch="noarch"
license="GPL-3.0-or-later"
depends="python3 py3-vobject py3-dateutil py3-setuptools"
pkgusers="radicale"
pkggroups="radicale"
install="$pkgname.pre-install"
options="!check"  # no test suite
source="https://files.pythonhosted.org/packages/source/R/Radicale/Radicale-$pkgver.tar.gz
	$pkgname.initd"
subpackages="$pkgname-openrc"
builddir="$srcdir/Radicale-$pkgver"

build() {
	python3 setup.py build
}

package() {
	python3 setup.py install --skip-build --prefix=/usr \
		--root="$pkgdir"

	install -d "$pkgdir"/etc/radicale
	install -m640 -g radicale config "$pkgdir"/etc/radicale/
	install -m640 -g radicale logging "$pkgdir"/etc/radicale/

	install -d -o radicale "$pkgdir"/var/lib/radicale \
		"$pkgdir"/var/log/radicale
	install -Dm755 "$srcdir"/radicale.initd \
		"$pkgdir"/etc/init.d/radicale
}

sha512sums="a708fb1269f7ba8c9e351e101f613a8adb18c12b1239b832ed9e0287476f30aa7ded30f9bc259da9c4b5f3aefe90bbf9980d0d08d98dd07b79cd19930b0e204c  Radicale-2.1.12.tar.gz
9856e5dbea45a6d2de592191fb97c310453a839e386a81c2ba0f28a9fb6005d8e8284b0ff59e02950bac3f5f1107aadb109baffc6c9445885792b50af959c740  radicale.initd"
