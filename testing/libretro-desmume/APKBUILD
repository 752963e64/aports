# Contributor: David Demelier <markand@malikania.fr>
# Maintainer: David Demelier <markand@malikania.fr>
pkgname=libretro-desmume
pkgver=0_git20210514
pkgrel=0
_commit="0bc055a126a3a5c2a9d0be3181edcc571dcb8ca6"
pkgdesc="libretro core for desmume"
url="https://github.com/libretro/desmume"
arch="all !ppc64le !s390x"
license="GPL-2.0-only"
makedepends="libpcap-dev mesa-dev"
source="$pkgname-$_commit.tar.gz::https://github.com/libretro/desmume/archive/$_commit.tar.gz"
builddir="$srcdir/desmume-$_commit"
options="!check" # No tests

case $CARCH in
arm*)
	_args="platform=armvhardfloat" ;;
aarch64)
	_args="DESMUME_JIT=0" ;;
esac

build() {
	make -C desmume/src/frontend/libretro $_args
}

package() {
	install -Dm644 desmume/src/frontend/libretro/desmume_libretro.so \
		"$pkgdir"/usr/lib/libretro/desmume_libretro.so
}

sha512sums="a2117262840eff762ef46bdd1ebc558b8da7e8cb6d618ff9c543f52db765c89159abf5582c9b299de476a3248fe6d6441d2b2a1015a4c9929345352493fb4cdf  libretro-desmume-0bc055a126a3a5c2a9d0be3181edcc571dcb8ca6.tar.gz"
