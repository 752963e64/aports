# Contributor: ScrumpyJack <scrumpyjack@st.ilet.to>
# Maintainer: ScrumpyJack <scrumpyjack@st.ilet.to>
pkgname=pam-krb5
pkgver=4.9
pkgrel=0
pkgdesc="PAM module providing Kerberos v5 support"
url="https://www.eyrie.org/~eagle/software/pam-krb5/"
arch="all"
license="BSD-3-Clause OR GPL-1.0-or-later"
makedepends="krb5-dev linux-pam-dev"
checkdepends="perl" # To run all tests a running KDC is required
subpackages="$pkgname-doc"
source="https://archives.eyrie.org/software/kerberos/pam-krb5-$pkgver.tar.gz
	fix-tests_basic-t.patch
	"

build() {
	./configure \
		--prefix=/usr \
		--enable-reduced-depends \
		--libdir=/usr/lib
	make
}

check() {
	make check
}

package() {
	make DESTDIR="$pkgdir" install
	install -Dm644 LICENSE "$pkgdir/usr/share/licenses/$pkgname/LICENSE"
}

sha512sums="0e93fbfacf56f9935902ead000dc46732c8a11cc2689c00b68cbaaf6519108a4ce53bb943479d01e439fb92bcc5c1a219d2b816a5ade2af54ea093bb78907201  pam-krb5-4.9.tar.gz
045560d2676f2742cf0a4fca4761363fa97da9408157aa82d386848c684f117324260c50de3d9ecc58fe8eabdd3f9f9dd5711e9ae184085ce5773ac7612ac268  fix-tests_basic-t.patch"
