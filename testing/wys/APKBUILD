# Contributor: Clayton Craft <clayton@craftyguy.net>
# Maintainer: Clayton Craft <clayton@craftyguy.net>
pkgname=wys
pkgver=0.1.8
pkgrel=0
pkgdesc="A daemon to bring up and take down PulseAudio loopbacks for phone call audio."
arch="all !mips64" # blocked by modemmanager
url="https://source.puri.sm/Librem5/wys"
license="GPL-3.0-or-later"
makedepends="meson pulseaudio-dev glib-dev modemmanager-dev"
source="
	$pkgname-$pkgver.tar.gz::https://source.puri.sm/Librem5/wys/-/archive/v$pkgver/wys-v$pkgver.tar.gz
	wys.desktop"
builddir=$srcdir/$pkgname-v$pkgver

build() {
	abuild-meson build
	meson compile ${JOBS:+-j ${JOBS}} -C build
}

check() {
	meson test --no-rebuild -v -C build
}

package() {
	DESTDIR="$pkgdir" meson install --no-rebuild -C build
	install -D -m644 $srcdir/wys.desktop $pkgdir/etc/xdg/autostart/wys.desktop
}

sha512sums="b8ae3b514b8786cefe8249208a4df8f69c7a40224b4a61defa53a56d911926b6e1e36e941c512d601654b79a933de9428b7bf4ba33a6646a3e98cf88eed5725b  wys-0.1.8.tar.gz
0f67c24d9af727e803d5cdb2dc01c7d99a2bfe33414fdc29cf5ec34c5a308b3a5f65970832087310e25e4ba7dc706b5a1d1ae99ab595d7264e972047a08f71e4  wys.desktop"
