# Contributor: Kevin Daudt <kdaudt@alpinelinux.org>
# Maintainer: Kevin Daudt <kdaudt@alpinelinux.org>
pkgname=go-task
pkgver=3.4.3
pkgrel=0
pkgdesc="Task runner written in Go"
url="https://taskfile.dev/"
arch="all"
license="MIT"
makedepends="go"
subpackages="$pkgname-doc"
source="$pkgname-$pkgver.tar.gz::https://github.com/go-task/task/archive/refs/tags/v$pkgver.tar.gz"
builddir="$srcdir/task-$pkgver"

export GOPATH="$srcdir/go"
export GOCACHE="$srcdir/go-build"
export GOTMPDIR="$srcdir"

export GOFLAGS="$GOFLAGS -modcacherw"

build() {
	go build -v -ldflags="-X main.version=$pkgver" github.com/go-task/task/v3/cmd/task
}

check() {
	go test -v ./...
}

package() {
	install -Dm0755 task "$pkgdir"/usr/bin/go-task
	install -Dm0644 docs/usage.md "$pkgdir"/usr/share/doc/go-task/usage.md
}

sha512sums="
5e8ce3fd7a5701d49c148894bf0c3457d76f92477b94fc4ba5669c4b2eb377656c6b5d6b501d46ebddd47f6327d1c90cd4b6d37fe75f949984dfdd8367c2020a  go-task-3.4.3.tar.gz
"
