# Contributor: Kevin Daudt <kdaudt@alpinelinux.org>
# Maintainer: Kevin Daudt <kdaudt@alpinelinux.org>
pkgname=go-task
pkgver=3.5.0
pkgrel=0
pkgdesc="Task runner written in Go"
url="https://taskfile.dev/"
arch="all"
license="MIT"
makedepends="go"
subpackages="$pkgname-doc"
source="$pkgname-$pkgver.tar.gz::https://github.com/go-task/task/archive/refs/tags/v$pkgver.tar.gz"
builddir="$srcdir/task-$pkgver"

export GOPATH="$srcdir/go"
export GOCACHE="$srcdir/go-build"
export GOTMPDIR="$srcdir"

export GOFLAGS="$GOFLAGS -modcacherw"

build() {
	go build -v -ldflags="-X main.version=$pkgver" github.com/go-task/task/v3/cmd/task
}

check() {
	go test -v ./...
}

package() {
	install -Dm0755 task "$pkgdir"/usr/bin/go-task
	install -Dm0644 docs/usage.md "$pkgdir"/usr/share/doc/go-task/usage.md
}

sha512sums="
63dff6b6d93c1540ae5f258f5fae8acd1101db14fa0e05714526e763b7beb29ea8b0dc5eac4e024b4d427b10cad392d66e5d5b771efacec6f51066cb2061e4e2  go-task-3.5.0.tar.gz
"
