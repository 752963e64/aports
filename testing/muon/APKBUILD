# Contributor: KikooDX <kikoodx@paranoici.org>
# Maintainer: KikooDX <kikoodx@paranoici.org>
pkgname=muon
pkgver=0_git20211008
pkgrel=0
pkgdesc="meson implementation in C"
options="!check" # broken test suite
url="https://sr.ht/~lattis/muon"
_giturl="https://github.com/annacrombie/muon"
arch="all"
license="GPL-3.0-only"
depends="samurai"
makedepends="pkgconf-dev curl-dev zlib-dev"
subpackages="$pkgname-doc"
_gitrev=354d545b7e62d2e15c1a4a8be844967b8962d920
source="$pkgname-$_gitrev.tar.gz::$_giturl/archive/$_gitrev.tar.gz"
builddir="$srcdir/$pkgname-$_gitrev"

prepare() {
	default_prepare
	./bootstrap.sh bootstrap
}

build() {
	bootstrap/muon setup \
		-Dstatic=false \
		-Dcurl=enabled \
		-Dzlib=enabled \
		-Dlibpkgconf=enabled \
		-Dsamu=disabled \
		build
	ninja -C build
}

package() {
	install -Dm711 build/muon "$pkgdir"/usr/bin/muon
	install -Dm644 LICENSE "$pkgdir"/usr/share/licenses/$pkgname/LICENSE
}

sha512sums="
478949d38f2b317fc825411441b763110069fb877c52140e8ae9b51816504b15483ebc18ee6e0ed5317f4c048704e20a9ee4ba435da685a51254c421887d38ef  muon-354d545b7e62d2e15c1a4a8be844967b8962d920.tar.gz
"
