# Contributor: Sören Tempel <soeren+alpine@soeren-tempel.net>
# Maintainer: Sören Tempel <soeren+alpine@soeren-tempel.net>
pkgname=noprs
pkgver=20191027
pkgrel=0
pkgdesc="Close all new GitHub PRs for an organization"
url="https://github.com/nmeum/noprs"
arch="noarch"
license="AGPL-3.0-or-later"
depends="hy py3-pygithub"
makedepends="py3-setuptools"
subpackages="$pkgname-doc $pkgname-openrc"
options="!check" # doesn't have a test suite
install="$pkgname.pre-install"
source="$pkgname-$pkgver.tar.gz::https://github.com/nmeum/noprs/archive/$pkgver.tar.gz
	$pkgname.confd
	$pkgname.initd
	0001-Flush-standard-error-after-each-request.patch"

package() {
	install -Dm755 $pkgname.hy "$pkgdir"/usr/bin/$pkgname
	install -Dm644 README.md \
		"$pkgdir"/usr/share/doc/$pkgname/README.md

	# OpenRC configuration file contains confidential information.
	install -Dm755 "$srcdir"/$pkgname.initd \
		"$pkgdir"/etc/init.d/$pkgname
	install -Dm600 "$srcdir"/$pkgname.confd \
		"$pkgdir"/etc/conf.d/$pkgname
}

sha512sums="2b0541555803b9caf8a372cbff26c55e3e83de16593ab2ea5aa84c670d85397ef39028d99664cb1a210161dd8841d871903952e604deef8e0867d70508a6d5cb  noprs-20191027.tar.gz
e476b5e7a7607881fc9dee49819ee5ff4bf07a488d77bacf8f02b807b06964136626863883f70102fad6582af21099ff16844dc903554eb68108e7eddd8f0603  noprs.confd
8317ace5c81288f3b9247513d291240c79b490ee978cb0a74784b1f7acfb821faf31cb64769824c3abd06632069471d6c3d00bb495cc9d2e817d5f64fa2c10c5  noprs.initd
092de588006bae2b10bcb01a96454099b69ab4c0b7ca8d0bca1b45cb31abb8111dc70921e12b1418e77c2780dedcd2dee25d70be994321528e4b8a88350b738f  0001-Flush-standard-error-after-each-request.patch"
