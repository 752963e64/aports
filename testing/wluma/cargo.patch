From: Jakub Jirutka <jakub@jirutka.cz>
Date: Sun, 6 Feb 2022 22:23:00 +0100
Subject: [PATCH] Patch dependencies

- Link wayland-client.so at build-time (not necessary, but it's better).
- Use latest v4l and fix incorrect types (needed for building against musl).

--- a/Cargo.toml
+++ b/Cargo.toml
@@ -8,1 +8,1 @@
-wayland-client = { version = "0.29.0", features = ["dlopen"] }
+wayland-client = { version = "0.29.0", features = ["use_system_lib"] }
@@ -17,1 +17,1 @@
-v4l = { version = "0.12", features = ["libv4l"], default-features = false }
+v4l = { version = "0.12.2", features = ["libv4l"], default-features = false }
@@ -23,3 +23,6 @@
 
 [dev-dependencies]
 mockall = "0.10"
+
+[patch.crates-io]
+v4l = { path = "./libv4l-rs" }
--- a/Cargo.lock
+++ b/Cargo.lock
@@ -1084,9 +1084,7 @@
 
 [[package]]
 name = "v4l"
-version = "0.12.1"
-source = "registry+https://github.com/rust-lang/crates.io-index"
-checksum = "4f6eca58bca86b4b353b55e18828694f91e83dd7e9c4d7f127515e4687d5a8e9"
+version = "0.12.2"
 dependencies = [
  "bitflags",
  "libc",
@@ -1096,8 +1094,6 @@
 [[package]]
 name = "v4l-sys"
 version = "0.2.0"
-source = "registry+https://github.com/rust-lang/crates.io-index"
-checksum = "f91dc47f9668a0a1a0af7ba194f2d543a68c2ef9eb61888f89565d60b34247fe"
 dependencies = [
  "bindgen",
 ]
@@ -1184,7 +1180,6 @@
 checksum = "d9341df79a8975679188e37dab3889bfa57c44ac2cb6da166f519a81cbe452d4"
 dependencies = [
  "dlib",
- "lazy_static",
  "pkg-config",
 ]
 
