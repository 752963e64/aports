# Contributor: Francesco Colista <fcolista@alpinelinux.org>
# Maintainer: Francesco Colista <fcolista@alpinelinux.org>
pkgname=notus-scanner
pkgver=22.4.2
pkgrel=0
pkgdesc="Notus is a vulnerability scanner for creating results from local security checks "
url="https://github.com/greenbone/notus-scanner"
arch="noarch"
license="AGPL-3.0"
depends="mosquitto psutils py3-gnupg paho-mqtt-c"
makedepends="py3-gpep517 python3-dev py3-poetry-core py3-wheel"
checkdepends="py3-pytest"
source="$pkgname-$pkgver.tar.gz::https://github.com/greenbone/notus-scanner/archive/refs/tags/v$pkgver.tar.gz"

build() {
	gpep517 build-wheel \
		--wheel-dir dist \
		--output-fd 3 3>&1 >&2
}

check() {
	python3 -m venv --system-site-packages testenv
		testenv/bin/python3 -m installer dist/*.whl
}

package() {
	python3 -m installer -d "$pkgdir" dist/*.whl
}

sha512sums="
a9a4a82e5777fced11d29b76893d96ca59ce1d704d5d59ec671498a956042618a7a74595c2c7c4b74ef8c9b9b587323860a1bf26ac2bfb3483cd69bb2eeada75  notus-scanner-22.4.2.tar.gz
"
