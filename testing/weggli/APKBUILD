# Contributor: Michał Polański <michal@polanski.me>
# Maintainer: Michał Polański <michal@polanski.me>
pkgname=weggli
pkgver=0.2.1
pkgrel=0
pkgdesc="Semantic search tool for C and C++ codebases"
url="https://github.com/googleprojectzero/weggli"
license="Apache-2.0"
arch="all !s390x !mips64 !riscv64" # blocked by rust/cargo
makedepends="cargo"
source="https://github.com/googleprojectzero/weggli/archive/v$pkgver/weggli-$pkgver.tar.gz
	cargo-lock.patch
	"

build() {
	cargo build --release --locked
}

check() {
	cargo test --release --locked
}

package() {
	cargo install --locked --path . --root="$pkgdir"/usr
	rm "$pkgdir"/usr/.crates*
}

sha512sums="
480f0ac9b1d8d1cc4e85dc153a5b385c8de225f97e47b5099a9e606f5ee6b1cdf6dabb3d9f183239b184c38614500aa9d53fef0794353333600788238a6d3319  weggli-0.2.1.tar.gz
cd40daad69df728cb9efb500fd11ed6eba7c3dbbb3c371d1e2e0172d7ac6c0c938fd6d1dd13ef2e2119bcdcbf20d42ee10103719a0d565ba5befc14db1b694de  cargo-lock.patch
"
