# Contributor: Bart Ribbers <bribbers@disroot.org>
# Maintainer: Bart Ribbers <bribbers@disroot.org>
pkgname=tokodon
pkgver=0_git20210604
pkgrel=0
_commit="1d4abd932ac81ad76ead01ae3ce3c123020e8e98"
pkgdesc="A Mastodon client for Plasma and Plasma Mobile"
url="https://invent.kde.org/network/tokodon/"
# armhf blocked by extra-cmake-modules
arch="all !armhf"
license="GPL-3.0-only AND CC0-1.0"
depends="
	kirigami2
	"
makedepends="
	extra-cmake-modules
	kconfig-dev
	kcoreaddons-dev
	kdbusaddons-dev
	ki18n-dev
	kirigami2-dev
	knotifications-dev
	qt5-qtbase-dev
	qt5-qtkeychain-dev
	qt5-qtmultimedia-dev
	qt5-qtquickcontrols2-dev
	qt5-qtsvg-dev
	qt5-qtwebsockets-dev
	"
source="https://invent.kde.org/network/tokodon/-/archive/$_commit/tokodon-$_commit.tar.gz"
options="!check" # No tests
builddir="$srcdir/$pkgname-$_commit"

build() {
	cmake -B build \
		-DCMAKE_BUILD_TYPE=None \
		-DCMAKE_INSTALL_PREFIX=/usr
	cmake --build build
}

package() {
	DESTDIR="$pkgdir" cmake --install build

	install -Dm644 -t "$pkgdir"/usr/share/applications org.kde.tokodon.desktop
	install -Dm644 -t "$pkgdir"/usr/share/metainfo org.kde.tokodon.appdata.xml
}

sha512sums="
8e428d61248e772349aad16f983e336cfdce99cd3db60cd3f6dd1c1a6183dcd3208d0a7d8dcb0f050dd83b29592e89335a72e72ed3d5d073c14476f141918f64  tokodon-1d4abd932ac81ad76ead01ae3ce3c123020e8e98.tar.gz
"
