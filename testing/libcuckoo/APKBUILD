# Contributor: Grigory Kirillov <txgk@bk.ru>
# Maintainer: Grigory Kirillov <txgk@bk.ru>
pkgname=libcuckoo
pkgver=0.3
pkgrel=0
pkgdesc="High-performance concurrent hash table library"
url="https://github.com/efficient/libcuckoo"
# x86, armhf, armv7, aarch64 and ppc64le didn't pass the check
arch="all !x86 !armhf !armv7 !aarch64 !ppc64le"
license="Apache-2.0"
makedepends="cmake samurai"
source="https://github.com/efficient/libcuckoo/archive/v$pkgver/libcuckoo-$pkgver.tar.gz"

build() {
	cmake -B builddir -G Ninja \
		-DCMAKE_INSTALL_PREFIX=/usr \
		-DCMAKE_BUILD_TYPE=Release \
		-DBUILD_TESTS=1
	cmake --build builddir
}

check() {
	ctest --output-on-failure --test-dir builddir
}

package() {
	DESTDIR="$pkgdir" cmake --install builddir
}

sha512sums="
038d0a03364cba9e9f90a96215eed00d9bc7460e5444263bd8a0a39b21f118707dec4ab632f8ab5ac24bb93c5da43ac3d1c6240ab2bf7dcdc86e94b03ffb53d9  libcuckoo-0.3.tar.gz
"
