# Contributor: Matthias Ahouansou <matthias@ahouansou.cz>
# Maintainer: Matthias Ahouansou <matthias@ahouansou.cz>
pkgname=yazi
pkgver=0.2.2
pkgrel=0
pkgdesc="Blazing fast terminal file manager written in Rust, based on async I/O"
url="https://yazi-rs.github.io"
arch="all"
license="MIT"
makedepends="
	cargo
	cargo-auditable
	lua5.4-dev
"
subpackages="$pkgname-doc"
source="
	$pkgname-$pkgver.tar.gz::https://github.com/sxyazi/yazi/archive/refs/tags/v$pkgver.tar.gz
	system-lua.patch
"
options="net"

prepare() {
	default_prepare
	cargo fetch --target="$CTARGET" --locked
}

build() {
	cargo auditable build --release --frozen
}

check() {
	cargo test --frozen
}

package() {
	install -Dm755 target/release/yazi "$pkgdir"/usr/bin/yazi

	install -Dm644 LICENSE "$pkgdir"/usr/share/licenses/$pkgname/LICENSE
}

sha512sums="
6ec86bab02e329ea306606f78deca6ad753af7998e338a1f4a39a85ca0a5fbe7e7c8f9b95dba7632ccdc4863c6474de9c4696006a71324478ee33bc97161e64c  yazi-0.2.2.tar.gz
b4ebcaa5e93ae2e82c411943478de80d1ec0a3419c4ac5a39d32f4f27f457c0356cb1f71d9d510af780de44a6aa4652403cc415202c75bef3fa7647b1d01b5e0  system-lua.patch
"
