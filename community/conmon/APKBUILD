# Contributor: Michał Polański <michal@polanski.me>
# Maintainer: Michał Polański <michal@polanski.me>
pkgname=conmon
pkgver=2.0.32
pkgrel=1
pkgdesc="OCI container runtime monitor"
url="https://github.com/containers/conmon"
license="Apache-2.0"
arch="all"
makedepends="bash go-md2man glib-dev libseccomp-dev"
subpackages="$pkgname-doc"
source="https://github.com/containers/conmon/archive/v$pkgver/conmon-$pkgver.tar.gz"

prepare() {
	default_prepare

	# fix location of go-md2man
	sed -E "s/(GOMD2MAN =).*/\1 go-md2man/" -i docs/Makefile
}

build() {
	make
}

check() {
	./bin/conmon --version
}

package() {
	make install PREFIX=/usr DESTDIR="$pkgdir"
}

sha512sums="
8d696ea46a24e88c4d977c74ea116e3de59c08bd1690272f1278a78045816018ed1e5f807d4f053e9737efa3c94f4e7bd0a1274a549be66fb3fa0a3ab5ccd92e  conmon-2.0.32.tar.gz
"
