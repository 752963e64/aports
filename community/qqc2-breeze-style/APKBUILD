# Contributor: Bart Ribbers <bribbers@disroot.org>
# Maintainer: Bart Ribbers <bribbers@disroot.org>
pkgname=qqc2-breeze-style
pkgver=5.22.5
pkgrel=1
pkgdesc="Breeze inspired QQC2 style"
# armhf blocked by extra-cmake-modules
# s390x and mips64 blocked by kconfigwidgets
# riscv64 disabled due to missing rust in recursive dependency
arch="all !armhf !s390x !mips64 !riscv64"
url="https://www.plasma-mobile.org/"
license="LicenseRef-KDE-Accepted-LGPL AND LicenseRef-KFQF-Accepted-GPL"
depends="kirigami2"
makedepends="
	extra-cmake-modules
	kconfig-dev
	kconfigwidgets-dev
	kguiaddons-dev
	kiconthemes-dev
	kirigami2-dev
	qt5-qtbase-dev
	qt5-qtdeclarative-dev
	qt5-qtquickcontrols2-dev
	qt5-qtx11extras-dev
	"

case "$pkgver" in
	*.90*) _rel=unstable;;
	*) _rel=stable;;
esac
source="https://download.kde.org/$_rel/plasma/$pkgver/qqc2-breeze-style-$pkgver.tar.xz
	0001-Remove-x1.5-mobile-icon-sizing.patch
	0002-Use-kcoreaddons-macro-for-kirigami-plugin.patch
	0003-Always-build-kirigami-plugin.patch
	0004-Do-not-create-an-extra-KIconLoader-just-for-custom-palettes.patch
	0005-Port-to-the-new-C++-units-plugin-in-Kirigami.patch
	"
subpackages="$pkgname-dev"
options="!check" # No tests

build() {
	cmake -B build \
		-DCMAKE_BUILD_TYPE=None \
		-DCMAKE_INSTALL_PREFIX=/usr \
		-DCMAKE_INSTALL_LIBDIR=lib
	cmake --build build
}

check() {
	cd build
	CTEST_OUTPUT_ON_FAILURE=TRUE ctest
}

package() {
	DESTDIR="$pkgdir" cmake --install build
}

sha512sums="
17560976e7c1d291b7359b53ece1cda819595c84d92609ab2f3dd8ca5be870dc523377821b86a45852139385a219a2d271927b42c1a949cfd11df33fb35282ef  qqc2-breeze-style-5.22.5.tar.xz
12af2b0a96266b6f42919bd0c824fe9b5b6e77a86b8d70466ab1f727207f3834c657cb358c41618560509466543ba4b1e59cc76947bdd983628c3e9e6dfaa692  0001-Remove-x1.5-mobile-icon-sizing.patch
0e07a9ab711b3ff21b64a2ca196db46161987ef8228ef2f2b6e0c2dc510a932ca6e09db49f7159b5ad3b9fc4908c66e9d6482948a7aff57a8ff897daf7794373  0002-Use-kcoreaddons-macro-for-kirigami-plugin.patch
0267bd6bc34a5d6df17fd067078b8d245f264920277810e1041f37655007aeb5228b55d0ace52089b889c9ed871005fde0dd60eb832f8aa983a72f8efed5cd55  0003-Always-build-kirigami-plugin.patch
7af556580c0b1b750e5fcdeeb589e3462dd536a17e976f9eed8c2678f55cdae5084bdd84b893f3173609a7a986795c4303e49536011594428304e32cc569fc84  0004-Do-not-create-an-extra-KIconLoader-just-for-custom-palettes.patch
bf59365b80f116a11bb6944ee311f98cfada2f862df6c522b80eec73f05284cfffa2e780d4948760bc0f5bb38b1fbfab7a9aa0c21bc447765625be1790ea7b3d  0005-Port-to-the-new-C++-units-plugin-in-Kirigami.patch
"
