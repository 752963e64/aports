# Contributor: Jakub Jirutka <jakub@jirutka.cz>
# Maintainer: Jakub Jirutka <jakub@jirutka.cz>
pkgname=duckscript
pkgver=0.8.12
pkgrel=0
pkgdesc="Simple, extendable and embeddable scripting language"
url="https://sagiegurari.github.io/duckscript/"
arch="x86_64 armv7 armhf aarch64 x86 ppc64le"  # limited by rust/cargo
license="Apache-2.0"
makedepends="cargo openssl-dev"
source="https://github.com/sagiegurari/duckscript/archive/$pkgver/$pkgname-$pkgver.tar.gz
	native-tls.patch
	"

_cargo_opts="--frozen --no-default-features --features tls-native"

prepare() {
	default_prepare

	cargo fetch --locked
}

build() {
	cargo build $_cargo_opts --release
}

check() {
	cargo test $_cargo_opts
}

package() {
	install -D -m755 target/release/duck -t "$pkgdir"/usr/bin/
}

sha512sums="
322970921ac850c2b492813cacff8ce8618685579be27bb3afc7794748cc4163af327160a1dbd8810e821e5d57dda3fca5d38d63471e788a93cd4ac0b1ff3968  duckscript-0.8.12.tar.gz
07eea68dd8d663639efa1f0fc522e2f5b3902796e930128464b7e1d814d7832a1562044df1a6b4dc83c19dbad29cdeba3f52c33147909863789dec964ad43a5c  native-tls.patch
"
