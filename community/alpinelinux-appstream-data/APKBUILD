# Contributor: Rasmus Thomsen <oss@cogitri.dev>
# Maintainer: Rasmus Thomsen <oss@cogitri.dev>
pkgname=alpinelinux-appstream-data
pkgver=20200704
pkgrel=0
pkgdesc="Alpine Linux appstream data"
url="https://alpinelinux.org"
arch="x86_64 aarch64" # Only arches metadata is generated for
license="GPL-3.0-or-later"
options="!check" # Only XML data and icons - no tests
# Make sure to replace v3.12 with the appropriate branch when updating
source="
	$pkgname-icons-main-64x64-$pkgver-v3.12.tar.gz::https://appstream.alpinelinux.org/$pkgver/data/v3.12/main/icons-64x64.tar.gz
	$pkgname-icons-main-128x128-$pkgver-v3.12.tar.gz::https://appstream.alpinelinux.org/$pkgver/data/v3.12/main/icons-128x128.tar.gz
	$pkgname-repo-main-x86_64-$pkgver-v3.12.xml.gz::https://appstream.alpinelinux.org/$pkgver/data/v3.12/main/Components-x86_64.xml.gz
	$pkgname-repo-main-aarch64-$pkgver-v3.12.xml.gz::https://appstream.alpinelinux.org/$pkgver/data/v3.12/main/Components-aarch64.xml.gz
	$pkgname-icons-community-64x64-$pkgver-v3.12.tar.gz::https://appstream.alpinelinux.org/$pkgver/data/v3.12/community/icons-64x64.tar.gz
	$pkgname-icons-community-128x128-$pkgver-v3.12.tar.gz::https://appstream.alpinelinux.org/$pkgver/data/v3.12/community/icons-128x128.tar.gz
	$pkgname-repo-community-x86_64-$pkgver-v3.12.xml.gz::https://appstream.alpinelinux.org/$pkgver/data/v3.12/community/Components-x86_64.xml.gz
	$pkgname-repo-community-aarch64-$pkgver-v3.12.xml.gz::https://appstream.alpinelinux.org/$pkgver/data/v3.12/community/Components-aarch64.xml.gz
"
builddir="$srcdir/"

unpack() {
	:
}

package() {
	mkdir -p "$pkgdir"/usr/share/app-info/xmls

	for _repo in main community; do
		mkdir -p \
		"$pkgdir"/usr/share/app-info/icons/alpinelinux-v3.12-$_repo/64x64 \
			"$pkgdir"/usr/share/app-info/icons/alpinelinux-v3.12-$_repo/128x128

			tar xf "$srcdir"/$pkgname-icons-$_repo-64x64-$pkgver-v3.12.tar.gz -C "$pkgdir"/usr/share/app-info/icons/alpinelinux-v3.12-$_repo/64x64
		tar xf "$srcdir"/$pkgname-icons-$_repo-128x128-$pkgver-v3.12.tar.gz -C "$pkgdir"/usr/share/app-info/icons/alpinelinux-v3.12-$_repo/128x128
		cp "$srcdir"/$pkgname-repo-$_repo-$CARCH-$pkgver-v3.12.xml.gz "$pkgdir"/usr/share/app-info/xmls/$_repo.xml.gz
	done
}

sha512sums="61629fb06472b2fcf48af9965769834cb704b3f5897b63d9b55052512b8bf839066b2647b1923c14dd2ab07ac5de9270b167966ee4dd93a44f944a4f9d807a44  alpinelinux-appstream-data-icons-main-64x64-20200704-v3.12.tar.gz
61629fb06472b2fcf48af9965769834cb704b3f5897b63d9b55052512b8bf839066b2647b1923c14dd2ab07ac5de9270b167966ee4dd93a44f944a4f9d807a44  alpinelinux-appstream-data-icons-main-128x128-20200704-v3.12.tar.gz
f3ebe4dbdc4a92fadc469ff3281970d6934343b9ebacff9e36ffe4f635b60b82269f23db5e5aab300dd428e2c36c29d478a861941298f7c987f25e1e4e36a076  alpinelinux-appstream-data-repo-main-x86_64-20200704-v3.12.xml.gz
f3ebe4dbdc4a92fadc469ff3281970d6934343b9ebacff9e36ffe4f635b60b82269f23db5e5aab300dd428e2c36c29d478a861941298f7c987f25e1e4e36a076  alpinelinux-appstream-data-repo-main-aarch64-20200704-v3.12.xml.gz
61629fb06472b2fcf48af9965769834cb704b3f5897b63d9b55052512b8bf839066b2647b1923c14dd2ab07ac5de9270b167966ee4dd93a44f944a4f9d807a44  alpinelinux-appstream-data-icons-community-64x64-20200704-v3.12.tar.gz
61629fb06472b2fcf48af9965769834cb704b3f5897b63d9b55052512b8bf839066b2647b1923c14dd2ab07ac5de9270b167966ee4dd93a44f944a4f9d807a44  alpinelinux-appstream-data-icons-community-128x128-20200704-v3.12.tar.gz
4d12d83e496e0952fae6f295338cf457fc8eaa750e6f9de5d91eebb21c2adcd55083eb0554aa8311ee0a1079e8238d2f0c5f76d41347076402c4bdf770422104  alpinelinux-appstream-data-repo-community-x86_64-20200704-v3.12.xml.gz
da1b98a3721bfd44cedcbb092911a8e500b3aba5291dc298fb024bc55285689d65f0e5d1a235f9e0f50bad2b29d27792afa0a7d124e85d9404f1c26dead7a243  alpinelinux-appstream-data-repo-community-aarch64-20200704-v3.12.xml.gz"
