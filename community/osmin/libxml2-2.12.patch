Patch-Source: https://github.com/Framstag/libosmscout/commit/db7b307de1a1146a6868015a0adfc2e21b7d5e39.patch
--
From db7b307de1a1146a6868015a0adfc2e21b7d5e39 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Luk=C3=A1=C5=A1=20Karas?= <lukas.karas@centrum.cz>
Date: Tue, 21 Nov 2023 21:49:25 +0100
Subject: [PATCH] fix build with libxml2 2.12.0

---
 libosmscout-gpx/src/osmscoutgpx/Import.cpp             | 10 +++++++++-
 .../src/osmscoutimport/PreprocessOSM.cpp               | 10 +++++++++-
 2 files changed, 18 insertions(+), 2 deletions(-)

diff --git a/libosmscout-gpx/src/osmscoutgpx/Import.cpp b/libosmscout-gpx/src/osmscoutgpx/Import.cpp
index 49ba6353d..0ff091a9e 100644
--- a/backend/libosmscout/libosmscout-gpx/src/osmscoutgpx/Import.cpp
+++ b/backend/libosmscout/libosmscout-gpx/src/osmscoutgpx/Import.cpp
@@ -335,12 +335,20 @@ class GpxParser{
     return xmlGetPredefinedEntity(name);
   }
 
-  static void StructuredErrorHandler(void* data, xmlErrorPtr error)
+  // overloaded method for libxml2 >= 2.12.0
+  static void StructuredErrorHandler(void* data, const xmlError *error)
   {
     auto* parser=static_cast<GpxParser*>(data);
     parser->Error("XML error, line " + std::to_string(error->line) + ": " + error->message);
   }
 
+  // overloaded method for libxml2 < 2.12.0
+  [[maybe_unused]]
+  static void StructuredErrorHandler(void* data, xmlErrorPtr error)
+  {
+    StructuredErrorHandler(data, static_cast<const xmlError*>(error));
+  }
+
   static void WarningHandler(void* data, const char* msg,...)
   {
     auto* parser=static_cast<GpxParser*>(data);
diff --git a/libosmscout-import/src/osmscoutimport/PreprocessOSM.cpp b/libosmscout-import/src/osmscoutimport/PreprocessOSM.cpp
index 7159e77a7..8b2514765 100644
--- a/backend/libosmscout/libosmscout-import/src/osmscoutimport/PreprocessOSM.cpp
+++ b/backend/libosmscout/libosmscout-import/src/osmscoutimport/PreprocessOSM.cpp
@@ -339,11 +339,19 @@ namespace osmscout {
     return xmlGetPredefinedEntity(name);
   }
 
-  static void StructuredErrorHandler(void* /*data*/, xmlErrorPtr error)
+  // overloaded method for libxml2 >= 2.12.0
+  static void StructuredErrorHandler(void* /*data*/, const xmlError *error)
   {
     std::cerr << "XML error, line " << error->line << ": " << error->message << std::endl;
   }
 
+  // overloaded method for libxml2 < 2.12.0
+  [[maybe_unused]]
+  static void StructuredErrorHandler(void* data, xmlErrorPtr error)
+  {
+    StructuredErrorHandler(data, static_cast<const xmlError*>(error));
+  }
+
   static void WarningHandler(void* /*data*/, const char* msg,...)
   {
     std::cerr << "XML warning:" << msg << std::endl;
