From 62c6f47040e038868b6f4030b9bf5baabe352701 Mon Sep 17 00:00:00 2001
From: 6543 <6543@obermui.de>
Date: Sun, 11 Apr 2021 15:39:31 +0200
Subject: [PATCH] use repo1_bare to test against

---
 modules/git/blob_test.go | 37 +++++++++++--------------------------
 1 file changed, 11 insertions(+), 26 deletions(-)

diff --git a/modules/git/blob_test.go b/modules/git/blob_test.go
index 9043de595..d02251ed9 100644
--- a/modules/git/blob_test.go
+++ b/modules/git/blob_test.go
@@ -7,6 +7,7 @@ package git
 
 import (
 	"io/ioutil"
+	"path/filepath"
 	"testing"
 
 	"github.com/stretchr/testify/assert"
@@ -14,32 +15,15 @@ import (
 )
 
 func TestBlob_Data(t *testing.T) {
-	output := `Copyright (c) 2016 The Gitea Authors
-Copyright (c) 2015 The Gogs Authors
-
-Permission is hereby granted, free of charge, to any person obtaining a copy
-of this software and associated documentation files (the "Software"), to deal
-in the Software without restriction, including without limitation the rights
-to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
-copies of the Software, and to permit persons to whom the Software is
-furnished to do so, subject to the following conditions:
-
-The above copyright notice and this permission notice shall be included in
-all copies or substantial portions of the Software.
-
-THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
-IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
-FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
-AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
-LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
-OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
-THE SOFTWARE.
-`
-	repo, err := OpenRepository("../../.git")
-	assert.NoError(t, err)
+	output := "file2\n"
+	bareRepo1Path := filepath.Join(testReposDir, "repo1_bare")
+	repo, err := OpenRepository(bareRepo1Path)
+	if !assert.NoError(t, err) {
+		t.Fatal()
+	}
 	defer repo.Close()
 
-	testBlob, err := repo.GetBlob("a8d4b49dd073a4a38a7e58385eeff7cc52568697")
+	testBlob, err := repo.GetBlob("6c493ff740f9380390d5c9ddef4af18697ac9375")
 	assert.NoError(t, err)
 
 	r, err := testBlob.DataAsync()
@@ -53,13 +37,14 @@ THE SOFTWARE.
 }
 
 func Benchmark_Blob_Data(b *testing.B) {
-	repo, err := OpenRepository("../../.git")
+	bareRepo1Path := filepath.Join(testReposDir, "repo1_bare")
+	repo, err := OpenRepository(bareRepo1Path)
 	if err != nil {
 		b.Fatal(err)
 	}
 	defer repo.Close()
 
-	testBlob, err := repo.GetBlob("a8d4b49dd073a4a38a7e58385eeff7cc52568697")
+	testBlob, err := repo.GetBlob("6c493ff740f9380390d5c9ddef4af18697ac9375")
 	if err != nil {
 		b.Fatal(err)
 	}
-- 
2.31.1

