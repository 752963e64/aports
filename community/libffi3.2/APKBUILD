# Maintainer:
pkgname=libffi3.2
pkgver=3.2
pkgrel=0
pkgdesc="A portable, high level programming interface to various calling conventions."
url="http://sourceware.org/libffi"
arch="all"
license="MIT"
depends_dev="linux-headers"
makedepends_build="texinfo"
# on mips* ffitarget.h wants <asm/sgidefs.h>
makedepends_host="linux-headers"
source="ftp://sourceware.org/pub/libffi/libffi-$pkgver.tar.gz
	pax-dlmmap.patch
	gnu-linux-define.patch
	"
builddir="$srcdir/libffi-$pkgver"

build() {
	./configure \
		--build=$CBUILD \
		--host=$CHOST \
		--prefix=/usr \
		--enable-pax_emutramp
	make
}

package() {
	make DESTDIR="$pkgdir" install
	rm -rf "$pkgdir"/usr/share/man
	rm -rf "$pkgdir"/usr/share/info
	rm -rf "$pkgdir"/usr/include
	rm -rf "$pkgdir"/usr/lib/*.so
	rm -rf "$pkgdir"/usr/lib/*.a
	rm -rf "$pkgdir"/usr/lib/pkgconfig
	rm -rf "$pkgdir"/usr/lib/libffi-3.2
}

sha512sums="fed5f6eec86144608966857f54bd69a5faa43427f27bc9178ebe2c7a1cecf925c20dbd6df07a207ae469842874efcf5b99fb7e09db59cbd92ebfc0a7e1bb62b7  libffi-3.2.tar.gz
72486b389db16055ae4d7d33ba0cb05840537e28fe7a86aa89e2cb922592125d99c18c26c5df7ffde6282742e79f2b9126353e58b58f091f0486589e14dd6474  pax-dlmmap.patch
02e180232ff148b898959b11b184de6b69153e8e99289fb73a48377a5bf71ab8cddec77ed3be1f0b8720026caaf3fd468959673f30f273101dcf5fa8662176bd  gnu-linux-define.patch"
