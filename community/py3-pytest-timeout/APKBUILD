# Contributor: Oleg Titov <oleg.titov@gmail.com>
# Maintainer: Oleg Titov <oleg.titov@gmail.com>
pkgname=py3-pytest-timeout
_pyname=pytest-timeout
pkgver=1.4.1
pkgrel=0
pkgdesc="py.test plugin to abort hanging tests"
url="https://github.com/pytest-dev/pytest-timeout/"
arch="noarch"
license="MIT"
depends="py3-pytest"
makedepends="py3-setuptools"
checkdepends="py3-pexpect"
source="https://files.pythonhosted.org/packages/source/p/pytest-timeout/pytest-timeout-$pkgver.tar.gz"
builddir="$srcdir/$_pyname-$pkgver"
options="!check" # tests broken

build() {
	python3 setup.py build
}

check() {
	PYTHONPATH="$PWD/build/lib" python3 -m pytest -x
}

package() {
	python3 setup.py install \
		--prefix=/usr \
		--root="$pkgdir" \
		--single-version-externally-managed
}

sha512sums="b62b090365c1cfe1a4d544b5645f828e451ec5229313c50a26ce04ba6cb203ff9ab487c61fb000af342f3d499e11f67aff5f84ff5b00328a129f1f39d4aabf28  pytest-timeout-1.4.1.tar.gz"
