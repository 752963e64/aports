# Contributor: Stefan Wagner <stw@bit-strickerei.de>
# Maintainer: Stefan Wagner <stw@bit-strickerei.de>
pkgname=avr-libc
pkgver=2.0.0
pkgrel=5
pkgdesc="The C runtime library for the AVR family of microcontrollers"
url="https://github.com/avrdudes/avr-libc"
depends="gcc-avr"
makedepends="autoconf automake"
arch="all"
license="BSD 3-Clause"
subpackages="$pkgname-doc"
builddir="$srcdir/$pkgname-$pkgname-${pkgver//./_}-release"
source="avr-libc-$pkgver.tar.gz::https://github.com/avrdudes/avr-libc/archive/refs/tags/avr-libc-${pkgver//./_}-release.tar.gz"

build() {
	./bootstrap
	CC=avr-gcc ./configure \
		--build="$(/bin/sh config.guess)" \
		--host=avr \
		--prefix=/usr
	make
}

package() {
	make install DESTDIR="$pkgdir"
	if [ -d "$pkgdir"/usr/lib64 ]; then
		mv "$pkgdir"/usr/lib64/* "$pkgdir"/usr/lib/
		rmdir "$pkgdir"/usr/lib64
	fi
}

sha512sums="
07368322f4733cc2f60cadc7bbb07c23fee2323aeabb0c3dcde750ad4d97d80b1c8469afbe585045a0f9f2df59b807e11d1e0aebf4b1ef912beb2a6758e89ec3  avr-libc-2.0.0.tar.gz
"
