# Contributor: Leo <thinkabit.ukim@gmail.com>
# Maintainer: Michael Koloberdin <koloberdin@gmail.com>
pkgname=patchelf
pkgver=0.17.0
pkgrel=0
pkgdesc="Small utility to modify the dynamic linker and RPATH of ELF executables"
url="https://nixos.org/patchelf.html"
arch="all"
license="GPL-3.0-or-later"
makedepends="autoconf automake libtool"
subpackages="$pkgname-doc"
source="$pkgname-$pkgver.tar.gz::https://github.com/NixOS/patchelf/archive/$pkgver.tar.gz"

prepare() {
	default_prepare
	autoreconf -fiv
}

build() {
	./configure --prefix=/usr
	make
}

check() {
	case "$CARCH" in
		ppc64le) ;;
		x86) ;;
		*) make -C tests -j1 check ;;
	esac
}

package() {
	make DESTDIR="$pkgdir" install
}

sha512sums="
0db2294cc16a919a84a1bb71194b3ed7a87bb669f684e4cc0943b33899d69690097c59d5c9f8e631bc1b4136db7f10f7cb0fbb1c96912aee567a0fd7dc9c9588  patchelf-0.17.0.tar.gz
"
