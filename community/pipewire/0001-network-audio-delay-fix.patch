From 9f57341699db6bf8c0cf9ecd343805dcc1988735 Mon Sep 17 00:00:00 2001
From: Wim Taymans <wtaymans@redhat.com>
Date: Mon, 30 Aug 2021 21:26:33 +0200
Subject: [PATCH] module-pulse-tunnel: set the bufferattr right

tlength for playack and fragsize for capture.

See #1434
---
 src/modules/module-pulse-tunnel.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/src/modules/module-pulse-tunnel.c b/src/modules/module-pulse-tunnel.c
index ff2659794..db9fa7e63 100644
--- a/src/modules/module-pulse-tunnel.c
+++ b/src/modules/module-pulse-tunnel.c
@@ -552,7 +552,7 @@ static int create_pulse_stream(struct impl *impl)
 	bufferattr.prebuf = (uint32_t) -1;
 
 	if (impl->mode == MODE_CAPTURE) {
-		bufferattr.tlength = pa_usec_to_bytes(DEFAULT_LATENCY_USEC, &ss);
+		bufferattr.fragsize = pa_usec_to_bytes(DEFAULT_LATENCY_USEC, &ss);
 
 		res = pa_stream_connect_record(impl->pa_stream,
 				remote_node_target, &bufferattr,
@@ -560,7 +560,7 @@ static int create_pulse_stream(struct impl *impl)
 				PA_STREAM_ADJUST_LATENCY |
 				PA_STREAM_AUTO_TIMING_UPDATE);
 	} else {
-		bufferattr.fragsize = pa_usec_to_bytes(DEFAULT_LATENCY_USEC, &ss);
+		bufferattr.tlength = pa_usec_to_bytes(DEFAULT_LATENCY_USEC, &ss);
 
 		res = pa_stream_connect_playback(impl->pa_stream,
 				remote_node_target, &bufferattr,
-- 
GitLab

