# Contributor: Natanael Copa <ncopa@alpinelinux.org>
# Maintainer: Rasmus Thomsen <oss@cogitri.dev>
pkgname=vte3
pkgver=0.64.0
pkgrel=0
pkgdesc="Virtual Terminal Emulator library"
url="https://developer.gnome.org/vte/"
arch="all"
license="LGPL-2.0-or-later"
subpackages="$pkgname-dbg $pkgname-dev $pkgname-lang"
makedepends="
	gnutls-dev
	gobject-introspection-dev
	gperf
	gtk+3.0-dev
	gtk-doc
	icu-dev
	intltool
	libxml2-utils
	linux-headers
	meson
	ncurses-dev
	pango-dev
	pcre2-dev
	vala
	"
source="https://gitlab.gnome.org/GNOME/vte/-/archive/$pkgver/vte-$pkgver.tar.gz
	fix-W_EXITCODE.patch
	"

builddir="$srcdir/vte-$pkgver"

build() {
	abuild-meson . output \
		-Ddocs=false \
		-Dgtk4=false \
		-D_systemd=false
	meson compile ${JOBS:+-j ${JOBS}} -C output
}

check() {
	meson test --no-rebuild -v -C output
}

package() {
	DESTDIR="$pkgdir" meson install --no-rebuild -C output
}

sha512sums="114f600b9708b1b08b1e2d995042ecceb43fe153cb35487bff5bd725a9c184a894b375f16fcc789958956504365e4e74e54d1cdc75a89054b4a622860cb7ab7d  vte-0.64.0.tar.gz
b6c1856bf075c2e3e91a0d4aff700c59e738bd6abe4122a11d680f104a2dab9d99f7d836a3ef3020b25ceff0a37231a6561eb917f0e4b9f90837eb634d8f7f20  fix-W_EXITCODE.patch"
