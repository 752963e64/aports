# Contributor: Bart Ribbers <bribbers@disroot.org>
# Maintainer: Bart Ribbers <bribbers@disroot.org>
pkgname=mycroft-skills-manager
pkgver=0.8.8_git20210121
pkgrel=0
_commit="c5b3fdc98e3cdae47b9bba69fc5a17d66d3bc015"
pkgdesc="Mycroft Skills Manager"
url="https://github.com/MycroftAI/mycroft-skills-manager"
arch="noarch"
license="Apache-2.0"
depends="
	py3-fasteners
	py3-gitpython
	py3-lazy
	py3-pako
	py3-requests
	py3-xdg
	py3-yaml
	python3
	"
makedepends="py3-setuptools"
checkdepends="py3-pytest"
source="https://github.com/MycroftAI/mycroft-skills-manager/archive/$_commit/mycroft-skills-manager-$_commit.tar.gz
	0001-skills-to-xdg.patch
	"
# net required for tests
options="net"
builddir="$srcdir/$pkgname-$_commit"

build() {
	python3 setup.py build
}

check() {
	# test_main is broken, https://github.com/MycroftAI/mycroft-skills-manager/issues/80
	PYTHONPATH="$PWD/build/lib" pytest -k 'not test_main'
}

package() {
	python3 setup.py install --prefix=/usr --root="$pkgdir"
}

sha512sums="200889ed6309ba3e20da92da6e2aaa683c18508375fc5c89236e44ef32cda624f63e5036b754abac61acf82c309d2200cb1fcdbba09cb94900ef1d7960459fae  mycroft-skills-manager-c5b3fdc98e3cdae47b9bba69fc5a17d66d3bc015.tar.gz
0e8d418ff6095d8ab85c7635de7ea1050a919590408afa95ab9be74c30a4d1a560c2b1487877f8e5190e6866dad67f7714a52fe4159058f7d1241b243e35c8d9  0001-skills-to-xdg.patch"
