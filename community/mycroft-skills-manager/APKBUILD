# Contributor: Bart Ribbers <bribbers@disroot.org>
# Maintainer: Bart Ribbers <bribbers@disroot.org>
pkgname=mycroft-skills-manager
pkgver=0.8.8_git20210216
pkgrel=0
_commit="94e25ab76f57c3d1c202a353123cbf22d3136558"
pkgdesc="Mycroft Skills Manager"
url="https://github.com/MycroftAI/mycroft-skills-manager"
arch="noarch"
license="Apache-2.0"
depends="
	py3-fasteners
	py3-gitpython
	py3-lazy
	py3-pako
	py3-requests
	py3-xdg
	py3-yaml
	python3
	"
makedepends="py3-setuptools"
checkdepends="py3-pytest"
source="https://github.com/MycroftAI/mycroft-skills-manager/archive/$_commit/mycroft-skills-manager-$_commit.tar.gz"
# net required for tests
options="net"
builddir="$srcdir/$pkgname-$_commit"

build() {
	python3 setup.py build
}

check() {
	# test_main is broken, https://github.com/MycroftAI/mycroft-skills-manager/issues/80
	PYTHONPATH="$PWD/build/lib" pytest -k 'not test_main'
}

package() {
	python3 setup.py install --prefix=/usr --root="$pkgdir"
}

sha512sums="15d872a67d0c1d42fed274fa20ba9c18e413611872b1b4955dd5ef01714c7a575bb25388eccd57cb02827c13c86f99598f3b6655f76c14810a123c112096f5b6  mycroft-skills-manager-94e25ab76f57c3d1c202a353123cbf22d3136558.tar.gz"
