From 1ac21246a751031823179377c3eef7ed3d4d5686 Mon Sep 17 00:00:00 2001
From: Behdad Esfahbod <behdad@behdad.org>
Date: Mon, 25 Jul 2022 08:40:02 -0600
Subject: [PATCH] [hb-ft] Fix bitmap font rendering with hb_ft_font_changed()

Fixes https://github.com/harfbuzz/harfbuzz/issues/3754
Fixes https://github.com/harfbuzz/harfbuzz/issues/3755
---
 src/hb-ft.cc | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/src/hb-ft.cc b/src/hb-ft.cc
index 5c88a7f3bd..ef073475cb 100644
--- a/src/hb-ft.cc
+++ b/src/hb-ft.cc
@@ -1086,7 +1086,8 @@ hb_ft_font_changed (hb_font_t *font)
   }
 #endif
 
-  _hb_ft_hb_font_check_changed (font, ft_font);
+  ft_font->advance_cache.clear ();
+  ft_font->cached_serial = font->serial;
 }
 
 /**
