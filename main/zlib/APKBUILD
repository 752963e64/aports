# Maintainer: Natanael Copa <ncopa@alpinelinux.org>
pkgname=zlib
pkgver=1.2.11
pkgrel=4
pkgdesc="A compression/decompression Library"
arch="all"
license="Zlib"
url="https://zlib.net/"
subpackages="$pkgname-static $pkgname-dev $pkgname-doc"
source="https://zlib.net/zlib-$pkgver.tar.gz
	0001-Fix-a-bug-that-can-crash-deflate-on-some-input-when-.patch
	0002-Assure-that-the-number-of-bits-for-deflatePrime-is-v.patch
	"

build() {
	# we trade size for a little more speed.
	export CFLAGS="$CFLAGS -O2"
	CHOST="$CHOST" ./configure \
		--prefix=/usr \
		--libdir=/lib \
		--shared
	make
}

check() {
	make check
}

package() {
	make install \
		pkgconfigdir="/usr/lib/pkgconfig" \
		DESTDIR="$pkgdir"
}

sha512sums="
73fd3fff4adeccd4894084c15ddac89890cd10ef105dd5e1835e1e9bbb6a49ff229713bd197d203edfa17c2727700fce65a2a235f07568212d820dca88b528ae  zlib-1.2.11.tar.gz
a9ddddb3dff1612700f18ef1df7419599b19c2d87c49811c8f23628314d50e8217abeda65cd4ef5f97f1688f6e2d5b0c5d53410ab4d57482ce72754894f84e74  0001-Fix-a-bug-that-can-crash-deflate-on-some-input-when-.patch
5b956d9e53d26045f06c3870d87d9e4241bd217f42af2a8f46a9052f48bdea1d77d1bd529df16ad6d85c42ae259a20ffc1bb45bd743889897714dc2cf94022ff  0002-Assure-that-the-number-of-bits-for-deflatePrime-is-v.patch
"
